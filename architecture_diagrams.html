<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Expense Analyzer - Architecture Diagrams</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        h2 {
            color: #4facfe;
            border-bottom: 2px solid #4facfe;
            padding-bottom: 10px;
            margin-top: 40px;
        }
        .diagram-container {
            background: #f8f9ff;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #e0e6ff;
        }
        .mermaid {
            text-align: center;
        }
        .description {
            background: #e8f2ff;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #4facfe;
        }
        .tech-stack {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        .tech-item {
            background: #f0f4ff;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #d0d8ff;
        }
        .tech-item h4 {
            color: #4facfe;
            margin: 0 0 10px 0;
        }
        .cost-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
        }
        .cost-table th, .cost-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        .cost-table th {
            background: #4facfe;
            color: white;
        }
        .cost-table tr:hover {
            background: #f5f5f5;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ—ï¸ Smart Expense Analyzer Architecture</h1>
        
        <h2>ğŸ“Š System Architecture Overview</h2>
        <div class="diagram-container">
            <div class="mermaid">
                graph TB
                    User[ğŸ‘¤ User] --> Frontend[ğŸŒ Frontend<br/>S3 Static Website]
                    Frontend --> Dashboard[ğŸ“Š Real-time Dashboard<br/>Dynamic HTML]
                    Frontend --> Upload[ğŸ“¤ Upload Interface<br/>Drag & Drop]
                    
                    Upload --> API[ğŸšª API Gateway<br/>REST Endpoints]
                    API --> UploadLambda[âš¡ Upload API<br/>Lambda Function]
                    UploadLambda --> S3Docs[ğŸ“ S3 Documents<br/>Receipt Storage]
                    
                    S3Docs --> Trigger[ğŸ”” S3 Event Trigger]
                    Trigger --> Processor[ğŸ”„ Document Processor<br/>Lambda Function]
                    
                    Processor --> Textract[ğŸ” AWS Textract<br/>OCR Service]
                    Textract --> Extract[ğŸ“ Text Extraction]
                    Extract --> Categorize[ğŸ·ï¸ AI Categorization]
                    Categorize --> DynamoDB[(ğŸ—„ï¸ DynamoDB<br/>ExpenseRecords)]
                    
                    Dashboard --> GetAPI[ğŸ“Š Get Expenses API<br/>Lambda Function]
                    GetAPI --> DynamoDB
                    
                    style User fill:#e1f5fe
                    style Frontend fill:#f3e5f5
                    style API fill:#fff3e0
                    style Processor fill:#e8f5e8
                    style Textract fill:#fff8e1
                    style DynamoDB fill:#fce4ec
                    style Dashboard fill:#f1f8e9
            </div>
        </div>
        
        <div class="description">
            <strong>Architecture Flow:</strong> Users upload receipts via web interface to API Gateway, which stores files in S3. S3 events trigger Lambda processing with Textract OCR. Extracted data is categorized and stored in DynamoDB. Real-time dashboard fetches fresh data via API endpoints.
        </div>

        <h2>ğŸ”„ Sequence Diagram - Receipt Processing Flow</h2>
        <div class="diagram-container">
            <div class="mermaid">
                sequenceDiagram
                    participant U as ğŸ‘¤ User
                    participant F as ğŸŒ Frontend
                    participant AG as ğŸšª API Gateway
                    participant UL as âš¡ Upload Lambda
                    participant S3 as ğŸ“ S3 Bucket
                    participant PL as ğŸ”„ Process Lambda
                    participant T as ğŸ” Textract
                    participant DB as ğŸ—„ï¸ DynamoDB
                    participant GL as ğŸ“Š Get Lambda
                    
                    U->>F: 1. Upload Receipt File
                    F->>AG: 2. POST /upload
                    AG->>UL: 3. Invoke upload_api
                    UL->>S3: 4. Store File
                    S3->>PL: 5. S3 Event Trigger
                    PL->>T: 6. OCR Processing
                    T->>PL: 7. Return Extracted Text
                    PL->>PL: 8. Parse & Categorize
                    PL->>DB: 9. Store Expense Record
                    
                    U->>F: 10. View Dashboard
                    F->>AG: 11. GET /expenses
                    AG->>GL: 12. Invoke get_expenses
                    GL->>DB: 13. Query Expenses
                    DB->>GL: 14. Return Data
                    GL->>AG: 15. JSON Response
                    AG->>F: 16. API Response
                    F->>U: 17. Display Real-time Data
            </div>
        </div>
        
        <div class="description">
            <strong>Processing Flow:</strong> Receipt upload triggers automatic OCR processing, data extraction, categorization, and storage. Dashboard dynamically fetches fresh data from DynamoDB via API endpoints for real-time expense tracking.
        </div>

        <h2>ğŸ—ï¸ AWS Services Architecture</h2>
        <div class="diagram-container">
            <div class="mermaid">
                graph TD
                    subgraph Frontend["ğŸŒ Frontend Layer"]
                        S3F[ğŸ“ S3 Static Website<br/>Frontend Hosting]
                        CF[ğŸŒ CloudFront CDN<br/>Global Distribution]
                    end
                    
                    subgraph API["ğŸšª API Layer"]
                        AG[ğŸšª API Gateway<br/>REST Endpoints]
                        CORS[ğŸ”„ CORS Config<br/>Cross-Origin Support]
                    end
                    
                    subgraph Compute["âš¡ Compute Layer"]
                        L1[ğŸ“¤ Upload API Lambda<br/>File Upload Handler]
                        L2[ğŸ”„ Process Document Lambda<br/>OCR & Categorization]
                        L3[ğŸ“Š Get Expenses Lambda<br/>Data Retrieval API]
                    end
                    
                    subgraph Storage["ğŸ’¾ Storage Layer"]
                        S3D[ğŸ“ S3 Document Bucket<br/>Receipt Storage]
                        DDB[(ğŸ—„ï¸ DynamoDB Table<br/>Expense Records)]
                        CW[ğŸ“Š CloudWatch Logs<br/>Monitoring & Alerts]
                    end
                    
                    subgraph AI["ğŸ¤– AI/ML Services"]
                        TX[ğŸ” AWS Textract<br/>OCR Processing]
                        CAT[ğŸ·ï¸ Categorization Logic<br/>Expense Classification]
                    end
                    
                    S3F --> AG
                    AG --> L1
                    AG --> L3
                    L1 --> S3D
                    S3D --> L2
                    L2 --> TX
                    L2 --> CAT
                    L2 --> DDB
                    L3 --> DDB
                    L2 --> CW
                    L1 --> CW
                    L3 --> CW
                    
                    style S3F fill:#fff3e0
                    style S3D fill:#fff3e0
                    style DDB fill:#fce4ec
                    style L1 fill:#e8f5e8
                    style L2 fill:#e8f5e8
                    style L3 fill:#e8f5e8
                    style TX fill:#fff8e1
                    style AG fill:#f3e5f5
            </div>
        </div>

        <h2>ğŸ’° Cost Breakdown</h2>
        <div class="diagram-container">
            <div class="mermaid">
                pie title Monthly Cost Distribution ($3.93 Total)
                    "AWS Textract OCR" : 38
                    "Lambda Functions" : 5
                    "DynamoDB Storage" : 32
                    "S3 Storage & Requests" : 6
                    "API Gateway" : 9
                    "CloudWatch Monitoring" : 8
                    "CloudFront CDN" : 2
            </div>
        </div>

        <table class="cost-table">
            <thead>
                <tr>
                    <th>AWS Service</th>
                    <th>Usage Estimate</th>
                    <th>Monthly Cost (USD)</th>
                    <th>Cost Driver</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>AWS Textract</td>
                    <td>1,000 pages/month</td>
                    <td>$1.50</td>
                    <td>Pages Processed</td>
                </tr>
                <tr>
                    <td>DynamoDB</td>
                    <td>1GB storage, 1000 RCU/WCU</td>
                    <td>$1.25</td>
                    <td>Storage + Read/Write Units</td>
                </tr>
                <tr>
                    <td>API Gateway</td>
                    <td>100,000 API calls</td>
                    <td>$0.35</td>
                    <td>API Requests</td>
                </tr>
                <tr>
                    <td>CloudWatch</td>
                    <td>Standard monitoring</td>
                    <td>$0.30</td>
                    <td>Logs + Metrics</td>
                </tr>
                <tr>
                    <td>S3 Storage</td>
                    <td>10GB documents + website</td>
                    <td>$0.23</td>
                    <td>Storage + Requests</td>
                </tr>
                <tr>
                    <td>Lambda Functions</td>
                    <td>100,000 requests/month</td>
                    <td>$0.20</td>
                    <td>Requests + Duration</td>
                </tr>
                <tr>
                    <td>CloudFront</td>
                    <td>1GB data transfer</td>
                    <td>$0.10</td>
                    <td>Data Transfer</td>
                </tr>
                <tr style="background: #e8f5e8; font-weight: bold;">
                    <td><strong>Total</strong></td>
                    <td>-</td>
                    <td><strong>$3.93/month</strong></td>
                    <td>Low-volume usage</td>
                </tr>
            </tbody>
        </table>

        <h2>ğŸ› ï¸ Technology Stack</h2>
        <div class="tech-stack">
            <div class="tech-item">
                <h4>ğŸŒ Frontend</h4>
                <p>HTML5, CSS3, JavaScript<br/>Responsive Design<br/>Real-time API Calls</p>
            </div>
            <div class="tech-item">
                <h4>âš¡ Backend</h4>
                <p>AWS Lambda (Python 3.9)<br/>Serverless Functions<br/>Event-driven Processing</p>
            </div>
            <div class="tech-item">
                <h4>ğŸ—„ï¸ Database</h4>
                <p>Amazon DynamoDB<br/>NoSQL Document Store<br/>Auto-scaling</p>
            </div>
            <div class="tech-item">
                <h4>ğŸ“ Storage</h4>
                <p>Amazon S3<br/>Object Storage<br/>Static Website Hosting</p>
            </div>
            <div class="tech-item">
                <h4>ğŸšª API</h4>
                <p>API Gateway<br/>REST Endpoints<br/>CORS Support</p>
            </div>
            <div class="tech-item">
                <h4>ğŸ” OCR</h4>
                <p>AWS Textract<br/>Document Analysis<br/>Text Extraction</p>
            </div>
            <div class="tech-item">
                <h4>ğŸ“Š Monitoring</h4>
                <p>CloudWatch<br/>Logs & Metrics<br/>Performance Tracking</p>
            </div>
            <div class="tech-item">
                <h4>ğŸ” Security</h4>
                <p>IAM Roles & Policies<br/>Encryption at Rest<br/>TLS in Transit</p>
            </div>
        </div>

        <h2>ğŸ“ˆ Scalability & Performance</h2>
        <div class="diagram-container">
            <div class="mermaid">
                graph TD
                    A[Current Scale<br/>1-100 receipts/day] --> B[Lambda Auto-scaling<br/>On-demand Processing]
                    B --> C[Medium Scale<br/>1,000 receipts/day]
                    C --> D[Add Provisioned Concurrency<br/>Reduce Cold Starts]
                    D --> E[High Scale<br/>10,000+ receipts/day]
                    E --> F[SQS Queue Processing<br/>Batch Operations]
                    F --> G[Enterprise Scale<br/>Multi-region Deployment]
                    G --> H[DynamoDB Global Tables<br/>Cross-region Replication]
                    
                    style A fill:#e8f5e8
                    style B fill:#fff3e0
                    style C fill:#fff8e1
                    style D fill:#f3e5f5
                    style E fill:#fce4ec
                    style F fill:#f1f8e9
                    style G fill:#e1f5fe
                    style H fill:#f0f4ff
            </div>
        </div>

        <div class="description">
            <strong>Performance Metrics:</strong>
            <ul>
                <li><strong>Concurrent Users:</strong> 1000+ supported</li>
                <li><strong>API Response Time:</strong> < 2 seconds</li>
                <li><strong>Availability SLA:</strong> 99.9%</li>
                <li><strong>Auto-scaling:</strong> Automatic based on demand</li>
                <li><strong>Cold Start:</strong> < 1 second for Lambda functions</li>
                <li><strong>OCR Processing:</strong> 2-5 seconds per document</li>
            </ul>
        </div>

        <div class="description">
            <strong>Current Implementation:</strong> Optimized for low-to-medium traffic with serverless auto-scaling. Real-time dashboard with API-driven data fetching. Can handle 1000+ receipts per day without modifications. For higher loads, consider adding SQS queues, provisioned concurrency, and multi-region deployment.
        </div>
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true
            },
            sequence: {
                useMaxWidth: true,
                wrap: true
            }
        });
    </script>
</body>
</html>